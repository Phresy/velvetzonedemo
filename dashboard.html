<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard – VelvetZone</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <a href="index.html" class="logo">
        <span class="velvet">Velvet</span>Zone
        <span class="blockchain-badge">BLOCKCHAIN SECURED</span>
      </a>
      <div class="nav-links">
        <a href="browse.html">Browse</a>
        <a href="dashboard.html" class="active">Dashboard</a>
        <div class="auth-buttons">
          <button id="logoutBtn" class="btn btn-outline">Logout</button>
        </div>
      </div>
      <button class="hamburger">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </nav>

  <main class="dashboard-container">
    <div class="container">
      <div class="dashboard-header">
        <div>
          <h1 id="welcomeMessage">Welcome back</h1>
          <p id="welcomeSubtitle">Manage your account and connections</p>
        </div>
        <div class="wallet-balance">
          <i class="fas fa-wallet"></i>
          <span>₵0.00</span>
        </div>
      </div>

      <div id="dashboardContent" class="dashboard-content"></div>
    </div>
  </main>

  <footer class="blockchain-footer">
    <!-- Same footer as index.html -->
  </footer>

  <script type="module">
    import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { auth } from './js/firebase-config.js';

    const role = localStorage.getItem("userRole");
    const displayName = localStorage.getItem("displayName");
    const welcome = document.getElementById("welcomeMessage");
    const subtitle = document.getElementById("welcomeSubtitle");
    const content = document.getElementById("dashboardContent");
    const logoutBtn = document.getElementById("logoutBtn");

    // Display user info
    if (!role || !displayName) {
      welcome.textContent = "Welcome to VelvetZone";
      content.innerHTML = `
        <div class="dashboard-card">
          <div class="card-icon error">
            <i class="fas fa-exclamation-circle"></i>
          </div>
          <h3>Account Error</h3>
          <p>Something went wrong with your session. Please log in again.</p>
          <a href="login.html" class="btn btn-gradient">Login Again</a>
        </div>
      `;
    } else {
      welcome.textContent = `Welcome, ${displayName}`;
      
      if (role === "provider") {
        subtitle.textContent = "Manage your provider profile and services";
        content.innerHTML = `
          <div class="dashboard-grid">
            <div class="dashboard-card">
              <div class="card-icon primary">
                <i class="fas fa-user-edit"></i>
              </div>
              <h3>Profile</h3>
              <p>Update your profile information and photos to attract more clients</p>
              <a href="provider-profile.html" class="btn btn-outline">Edit Profile</a>
            </div>
            
            <div class="dashboard-card">
              <div class="card-icon secondary">
                <i class="fas fa-chart-line"></i>
              </div>
              <h3>Stats</h3>
              <p>View your profile visits and message statistics</p>
              <a href="stats.html" class="btn btn-outline">View Stats</a>
            </div>
            
            <div class="dashboard-card">
              <div class="card-icon accent">
                <i class="fas fa-crown"></i>
              </div>
              <h3>Upgrade</h3>
              <p>Get verified and boost your visibility with premium features</p>
              <a href="upgrade.html" class="btn btn-gradient">Go Premium</a>
            </div>
          </div>
          
          <div class="recent-activity">
            <h2>Recent Activity</h2>
            <div class="activity-list">
              <div class="activity-item">
                <div class="activity-icon">
                  <i class="fas fa-envelope"></i>
                </div>
                <div class="activity-details">
                  <p>You have 3 new messages</p>
                  <small>2 hours ago</small>
                </div>
                <a href="chat.html" class="activity-action">View</a>
              </div>
              <div class="activity-item">
                <div class="activity-icon">
                  <i class="fas fa-eye"></i>
                </div>
                <div class="activity-details">
                  <p>Your profile was viewed 12 times</p>
                  <small>Today</small>
                </div>
              </div>
            </div>
          </div>
        `;
      } else {
        subtitle.textContent = "Find your perfect match in your area";
        content.innerHTML = `
          <div class="dashboard-grid">
            <div class="dashboard-card">
              <div class="card-icon primary">
                <i class="fas fa-search"></i>
              </div>
              <h3>Browse Providers</h3>
              <p>Find service providers in your area</p>
              <a href="browse.html" class="btn btn-gradient">Browse Now</a>
            </div>
            
            <div class="dashboard-card">
              <div class="card-icon secondary">
                <i class="fas fa-comments"></i>
              </div>
              <h3>Messages</h3>
              <p>View your conversations</p>
              <a href="messages.html" class="btn btn-outline">View Messages</a>
            </div>
            
            <div class="dashboard-card">
              <div class="card-icon accent">
                <i class="fas fa-heart"></i>
              </div>
              <h3>Favorites</h3>
              <p>Your saved providers</p>
              <a href="favorites.html" class="btn btn-outline">View Favorites</a>
            </div>
          </div>
          
          <div class="recent-activity">
            <h2>Recommended Providers</h2>
            <div class="providers-scroll">
              <!-- These would be dynamically loaded from Firebase -->
              <div class="provider-mini">
                <img src="provider1.jpg" alt="Provider">
                <h4>Ama</h4>
                <p>Accra, Ghana</p>
                <a href="profile-view.html?id=123" class="btn btn-outline">View</a>
              </div>
              <div class="provider-mini">
                <img src="provider2.jpg" alt="Provider">
                <h4>Chioma</h4>
                <p>Lagos, Nigeria</p>
                <a href="profile-view.html?id=456" class="btn btn-outline">View</a>
              </div>
              <div class="provider-mini">
                <img src="provider3.jpg" alt="Provider">
                <h4>Nana</h4>
                <p>Kumasi, Ghana</p>
                <a href="profile-view.html?id=789" class="btn btn-outline">View</a>
              </div>
            </div>
          </div>
        `;
      }
    }

    // Logout functionality
    logoutBtn.addEventListener("click", async () => {
      try {
        await signOut(auth);
        localStorage.clear();
        window.location.href = "login.html";
      } catch (err) {
        alert("Logout failed. Try again.");
        console.error(err);
      }
    });
  </script>

  <style>
    .dashboard-container {
      padding: 100px 0 60px;
      min-height: 100vh;
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
    }

    .dashboard-header h1 {
      font-size: 2.2rem;
      margin-bottom: 5px;
    }

    .dashboard-header p {
      color: rgba(255, 255, 255, 0.7);
    }

    .wallet-balance {
      background: rgba(77, 166, 255, 0.1);
      padding: 15px 20px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.2rem;
    }

    .wallet-balance i {
      color: var(--secondary);
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }

    .dashboard-card {
      background: rgba(30, 30, 30, 0.6);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 30px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
      transition: transform 0.3s;
    }

    .dashboard-card:hover {
      transform: translateY(-5px);
      border-color: var(--primary);
    }

    .card-icon {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      font-size: 1.8rem;
    }

    .card-icon.primary {
      background: rgba(227, 6, 157, 0.1);
      color: var(--primary);
    }

    .card-icon.secondary {
      background: rgba(77, 166, 255, 0.1);
      color: var(--secondary);
    }

    .card-icon.accent {
      background: rgba(255, 193, 7, 0.1);
      color: #FFC107;
    }

    .card-icon.error {
      background: rgba(244, 67, 54, 0.1);
      color: #F44336;
    }

    .dashboard-card h3 {
      font-size: 1.4rem;
      margin-bottom: 15px;
    }

    .dashboard-card p {
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 20px;
      font-size: 0.95rem;
    }

    .dashboard-card .btn {
      margin: 0 auto;
    }

    .recent-activity {
      margin-top: 50px;
    }

    .recent-activity h2 {
      font-size: 1.5rem;
      margin-bottom: 20px;
      position: relative;
      padding-bottom: 10px;
    }

    .recent-activity h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50px;
      height: 2px;
      background: var(--primary);
    }

    .activity-list {
      background: rgba(30, 30, 30, 0.6);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
    }

    .activity-item {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .activity-item:last-child {
      border-bottom: none;
    }

    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(77, 166, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      color: var(--secondary);
    }

    .activity-details {
      flex: 1;
    }

    .activity-details p {
      margin-bottom: 5px;
    }

    .activity-details small {
      color: rgba(255, 255, 255, 0.5);
      font-size: 0.8rem;
    }

    .activity-action {
      color: var(--primary);
      text-decoration: none;
      font-size: 0.9rem;
    }

    .providers-scroll {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding-bottom: 20px;
    }

    .provider-mini {
      min-width: 200px;
      background: rgba(30, 30, 30, 0.6);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .provider-mini img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 15px;
    }

    .provider-mini h4 {
      margin-bottom: 5px;
    }

    .provider-mini p {
      color: rgba(255, 255, 255, 0.7);
      font-size: 0.9rem;
      margin-bottom: 15px;
    }

    @media (max-width: 768px) {
      .dashboard-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 20px;
      }

      .wallet-balance {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</body>
</html>